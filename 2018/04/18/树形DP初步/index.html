<html>
<head>
	
	<title>树形DP初步</title>
	<meta name="keywords" content="fzb.me,冯宗宝,冯宗宝的blog" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
	   <link href="/css/main.css?v=3" rel="stylesheet" type="text/css" />
    
        <script src="/js/util.js"></script>
        <script>
            if(isMobile()) {
                loadjscssfile('../css/mobile.css', 'css');
            } else {
                loadjscssfile('../css/desktop.css', 'css');
            }
        </script> 
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/p1.png?v=3"/>
    

</head>

<body>


<h2 class="title">树形DP初步</h2>
<!---
<div style="text-align:center;margin-top: -10px;">
<div class="article-category">
发表于2018年4月18日


    <a class="article-category-link" href="/categories/树形DP/">树形DP</a>



 </div>
--->
</div>

<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#POJ-2342"><span class="toc-text">POJ_2342</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二叉苹果树"><span class="toc-text">二叉苹果树</span></a></li></ol>
<p>树形DP是建立在树这种数据结构之上，通过dfs来维护根到叶子或者叶子到跟节点的状态转移</p>
<a id="more"></a>
<h1 id="POJ-2342"><a href="#POJ-2342" class="headerlink" title="POJ_2342"></a>POJ_2342</h1><p>树形DP入门题，非常经典</p>
<pre><code class="cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#define Memset(a,b) memset(a,b,sizeof(a))
#define maxn 6005
typedef long long LL;

using namespace std;

int dp[maxn][2];
int vis[maxn];
int father[maxn];
int n;

void dfs(int node){
  int i;
  vis[node] = 1;
  for(i=1;i&lt;=n;i++){
    if(father[i] == node &amp;&amp; !vis[i]){
      //递归
      dfs(i);
      dp[node][1] += dp[i][0];
      dp[node][0] += max(dp[i][0], dp[i][1]);
    }
  }
}

int main(){
  int c,f,root;
  while(cin &gt;&gt; n){
    Memset(father,0);
    Memset(vis,0);
    Memset(dp,0);
    for(int i = 1 ; i &lt;= n ;i++)
      scanf(&quot;%d&quot;, &amp;dp[i][1]);
    root=0;
    while(cin &gt;&gt; c &gt;&gt; f &amp;&amp; (c || f)){
      father[c] = f;
      root = f;
    }
    dfs(root);
    int maxx = max(dp[root][0], dp[root][1]);
    cout &lt;&lt; maxx &lt;&lt; endl;
  }
  return 0;
}
</code></pre>
<h1 id="二叉苹果树"><a href="#二叉苹果树" class="headerlink" title="二叉苹果树"></a>二叉苹果树</h1><p>这个题目就是转换为无向图的思想，将权值转移到边上就行了，网上的写法有的是利用前向星，但是这个太麻烦，所以我们可以直接利用<code>vector</code>数组来实现：</p>
<pre><code class="cpp">#include&lt;vector&gt;
#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;

struct Node{
    int next;
    int w;
};

vector&lt;Node&gt;vec[110];
int n,m;
int dp[110][110];

int dfs(int u, int father){
    int ans = 0;
    vector&lt;Node&gt;::iterator it;
    for(it = vec[u].begin() ; it != vec[u].end() ; it++){
        Node node = *it;
        int v = node.next, w = node.w;
        if(v == father) continue;
        ans += dfs(v,u)+1;
        for(int j = min(ans,m) ; j &gt;= 1; j--)
            for(int k = min(ans, j) ; k &gt;= 1 ;k--)
                dp[u][j] = max(dp[u][j], dp[u][j-k]+dp[v][k-1]+w);
    }
    return ans;
}

int main(){
    int u,v,w;
    while(cin &gt;&gt; n &gt;&gt; m){
        memset(dp,0,sizeof(dp));
        for(int i = 0 ; i &lt; n ;i++){
            cin &gt;&gt; u  &gt;&gt; v &gt;&gt; w;
            Node node1,node2;
            node1.next=v;
            node1.w=node2.w=w;
            node2.next=u;
            vec[u].push_back(node1);
            vec[v].push_back(node2);
        }
        dfs(1, -1);
        cout &lt;&lt; dp[1][m] &lt;&lt; endl;
    }
    return 0;
}
</code></pre>


<!--<a href="http://yoursite.com/2018/04/18/树形DP初步/#disqus_thread" class="article-comment-link">Comments</a>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'undefined'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
-->
<div style="display:none">
<script src="http://s4.cnzz.com/stat.php?id=undefined&web_id=undefined" language="JavaScript"></script>script>
</div>






</body>
</html>