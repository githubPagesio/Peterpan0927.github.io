<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="how to reach the steins gate?">
    

    <!--Author-->
    
        <meta name="author" content="Peter pan">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="TCP/IP(一)"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="how to reach the steins gate?" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Peterpan&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>TCP/IP(一) - Peterpan&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


</head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2017/08/24/TCP:IP-一/">
                TCP/IP(一)
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2017-08-24</span>
            
            
            
                <span class="category">
                    <a href="/categories/OSI模型-网络构成要素-地址/">OSI模型 网络构成要素 地址</a>
                </span>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <p>日常的生活中，我们无时不刻都在进行着互联网上的数据交互，那么数据如何进行传输的呢？</p>
<a id="more"></a>
<h1 id="tcpip一"><a class="markdownIt-Anchor" href="#tcpip一"></a> TCP/IP(一)</h1>
<p>Unix只针对大型主机或服务器，而Linux适用于x86的个人计算机</p>
<p>Linux的内核是运行程序和管理像磁盘和打印机等硬件设备的核心程序，它提供了一个在裸设备和应用程序之间的抽象层,简单来说如同心脏之于人，发动机之于汽车，CPU之于计算机，最后附上一个内核源码的<a href="https://www.kernel.org/" target="_blank" rel="external">下载地址</a>。</p>
<p>Linux在服务器领域的应用是其重要分支，其免费，稳定，高效等特点得到了很好的体验。</p>
<h2 id="tcpip的意义"><a class="markdownIt-Anchor" href="#tcpip的意义"></a> TCP/IP的意义</h2>
<p>不同硬件，操作系统之间的通信都需要一种规则，我们把这种规则称作协议，而其中的TCP/IP协议则是互联网相关的各类协议族的总称。</p>
<h2 id="osi七层模型"><a class="markdownIt-Anchor" href="#osi七层模型"></a> OSI七层模型</h2>
<p><img src="http://omunhj2f1.bkt.clouddn.com/osi1-5.png" alt=""></p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/osi4-1.png" alt=""></p>
<p>因为计算机不像人一样拥有随机应变的能力，所以我们需要应对各种异常情况并进行处理，其中OSI模型对通信中的必要功能进行了很好的归纳，但是由于没有对协议和接口进行详细的定义，对于学习协议只能起一个引导作用。</p>
<h2 id="osi参考模型通信处理举例"><a class="markdownIt-Anchor" href="#osi参考模型通信处理举例"></a> OSI参考模型通信处理举例</h2>
<p><img src="http://omunhj2f1.bkt.clouddn.com/osi%E6%A8%A1%E5%9E%8B%E5%8F%82%E8%80%83%E4%B8%BE%E4%BE%8B.png" alt=""></p>
<p>为了方便理解，我们举一个例子，如上图所示，A向B发一个邮件问好：</p>
<ul>
<li>应用层</li>
</ul>
<p>用户输入完点击发送的时候，就进入了应用层协议的处理，通过电子邮件协议，该协议会在传输数据的首部附加一个信息，标明邮件的内容和收件人。当收件人B收到数据后会进行相应的处理，如果邮箱已满则会返回异常，这类异常是应用层需要处理的问题。</p>
<ul>
<li>表示层</li>
</ul>
<p>所使用的应用软件的不同都会导致数据的表现形式截然不同，为了顺利的收发邮件，要将数据通过某个计算机的格式转换成网络通用格式，目标方收到后再转换成该主机特有的数据格式，表示层之间为了识别编码格式也会附加首部信息</p>
<ul>
<li>会话层</li>
</ul>
<p>决定了两个主机之间如何进行高效的数据交互，A要同时发五个邮件给B，可以建立一次连接发一次，也可以建立好之后一次性发过去，也可以建立五个连接同时发过去，采用什么连接方式是会话层的主要责任，同时头部也会附上数据的传输顺序的信息。</p>
<ul>
<li>传输层</li>
</ul>
<p>如果说会话层是负责建立什么样的连接，那么传输层就是建立连接和断开连接，在两个主机之间创建逻辑的通信连接，为了确保数据到达目标地址，会在通信两端的计算机进行确认，如果数据没有送达，它会负责重发。</p>
<p>比如某种原因，B只收到&quot;早上&quot;，没有收到&quot;好&quot;,然后就会把这个数据返回给A，A的之后再把&quot;好&quot;发送过去，并再次确认是否收到。就好比我们日常生活中有人问<code>你刚才说什么？</code></p>
<ul>
<li>网络层</li>
</ul>
<p>网络层负责将数据发送至最终目标地址，虽然两端主机之间有众多的数据链路，但是这是下一层数据链路层的事情，网络层会将其从上层收到的数据和地址信息发送给下面的数据链路层。简单的说就是网络层负责的是端对端的通信。</p>
<ul>
<li>数据链路层</li>
</ul>
<p>数据链路层的作用是在通过传输介质互联的设备之间进行数据处理，和上层的关系可以用一张图来表示：</p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/697D6930A9BFC709E63475EDB8C2AB4E.png" alt=""></p>
<p>相互连接的设备之间使用地址实现传输。这种地址被称为MAC地址。</p>
<ul>
<li>物理层</li>
</ul>
<p>将数据的0、1转换为电压和脉冲光传输给物理的传输介质，传输到别的设备然后再通过自下而上的方式对信息解析。</p>
<h2 id="传输方式的分类"><a class="markdownIt-Anchor" href="#传输方式的分类"></a> 传输方式的分类</h2>
<h3 id="面向有连接型和面向无连接型"><a class="markdownIt-Anchor" href="#面向有连接型和面向无连接型"></a> 面向有连接型和面向无连接型</h3>
<ul>
<li>面向有连接型</li>
</ul>
<p>在发送数据之前，要在收发主机之间连接一条通信线路。就好像给别人打电话需要对方接通后才能进行通话。需要在通信传输的前后，专门进行建立和断开连接的处理，如果对端无法通信，可以避免发送无谓的数据。</p>
<ul>
<li>面向无连接型</li>
</ul>
<p>不要求建立和断开连接。发送端可以在任何时候对接收端发送数据，在这种情况下，是接收方需要时常确认是否受到数据。就像人们去邮局寄包裹的时候，不需要管收件人的地址是否存在，只需要写上这个地址即可以办理邮寄包裹的业务。</p>
<h3 id="电路交换和分组交换"><a class="markdownIt-Anchor" href="#电路交换和分组交换"></a> 电路交换和分组交换</h3>
<p>目前网络通信方式大致分为两种—电路交换和分组交换.电路交换技术相对来说比较久远，主要用于过去的电话网。而分组交换技术从上世纪60年代才逐渐被人们所认可，TCP/IP也正是采用了分组交换技术。</p>
<ul>
<li>电路交换</li>
</ul>
<p>某条电路只是用来连接两台计算机的通信线路，就意味着一台计算机在收发信息的时候会独占整个电路，其他的计算机只能等这台计算机使用结束之后才有机会使用这个电路收发数据，但是谁都无法预测什么时候通信开始和结束，所以如果并发用户超过交换机之间的通信线路数，就意味着通信根本无法实现。</p>
<ul>
<li>分组交换</li>
</ul>
<p>聪明的人类想到了一个方法来解决这个问题～：将连接到通信电路的计算机所要发送的数据分成多个数据包，按照一定的顺序排列之后再发送，因为在包的首部写入发送端和接收端的地址，所以可以唯一确认。</p>
<p>发送端计算机将数据分组发送给路由器，路由器接收到数据以后会按照顺序缓存到相应的队列中，再以先进先出的原则发送出去。</p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/22E392D96C18B8E857BDC0D431FCC14C.png" alt=""></p>
<h2 id="地址"><a class="markdownIt-Anchor" href="#地址"></a> 地址</h2>
<h3 id="地址的唯一性"><a class="markdownIt-Anchor" href="#地址的唯一性"></a> 地址的唯一性</h3>
<p>如果要让地址在通信中发挥作用，通信的主体也就是是信息收发端必须是唯一的表示一个对象。同一个</p>
<p>通信网络中不能有两个地址相同的通信主体存在,这也就是地址的唯一性。</p>
<p>这里可能会有一个疑问，对于单播还比较好理解，在多播、广播中是怎么保证地址的唯一行的呢？</p>
<p>在这种接收端设备不止一个的情况下，可以对这些由多个设备组成的一组通信赋予同一个具有唯一特性的地址：</p>
<p>那么我们可以举几个例子来说明以下几种情况，如果说单播是校长找小茗同学谈话：</p>
<ul>
<li>多播</li>
</ul>
<p>某位老师说：三年级五班的同学到操场集合。那么三年五班就是这次多播的目标地址，具有唯一性</p>
<ul>
<li>广播</li>
</ul>
<p>同样的，校长说，我校师生起立，那么全校就是广播的目标地址，也具有唯一性</p>
<ul>
<li>任播</li>
</ul>
<p>在领取教材的时候，主任说七班任意来一位同学拿名册，任意一位同学就是这次任播的目标地址</p>
<h3 id="地址的层次性"><a class="markdownIt-Anchor" href="#地址的层次性"></a> 地址的层次性</h3>
<p>当地址不是很多的时候，有唯一地址就可以确定通信主体，但是在当今庞大的互联网中，地址除了具有唯一性还需要具有层次性。其实在电话号码中就已经有这种设定了，电话号码包括国家区号和国内区号，这样就可以更加快速的定位；</p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/8728D70860794E71410D42FE4A2709F4.png" alt=""></p>
<p>MAC地址和IP地址在标识一个通信主体时虽然都具有唯一性，但只有IP地址具有层次性。</p>
<p>MAC地址由设备的制造厂商对每块网卡进行分别的指定，而IP地址通过网络号和主机号两部分组成。主机号不同，网络号相同，说明他们处于同一个网段。另一方面，网络号相同的主机在提供商类型，地域分布上都比较集中。这也是为什么说IP地址具有层次性。</p>
<p>网络传输中，每个节点会根据分组数据的地址信息，来判断报文应该从哪个网卡发出去。为此，各个地址都会参考一个发出接口列表。这一点上MAC寻址和IP寻址是一样的。只不过MAC寻址所参考的这个表叫做地址转发表，而IP寻址中所参考的叫做路由控制表。一个记录的是实际的MAC地址，一个是集中后的网络号。比如下面这个例子：</p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/280123794EEFF716EF4A094084DE7FB5.png" alt=""></p>
<h2 id="网络的构成要素"><a class="markdownIt-Anchor" href="#网络的构成要素"></a> 网络的构成要素</h2>
<table>
<thead>
<tr>
<th style="text-align:center">设备</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">网卡（NIC）</td>
<td style="text-align:center">是计算机联网的设备</td>
</tr>
<tr>
<td style="text-align:center">中继器</td>
<td style="text-align:center">从物理层上延长网络的设备</td>
</tr>
<tr>
<td style="text-align:center">网桥/2层交换机</td>
<td style="text-align:center">从数据链路层上延长网络的设备</td>
</tr>
<tr>
<td style="text-align:center">路由器/3层交换机</td>
<td style="text-align:center">通过网络层转发分组数据的设备</td>
</tr>
<tr>
<td style="text-align:center">4~7层交换机</td>
<td style="text-align:center">处理传输层以上各层网络传输的设备</td>
</tr>
<tr>
<td style="text-align:center">网关</td>
<td style="text-align:center">转换协议的设备</td>
</tr>
</tbody>
</table>
<p>这里中继器和交换机方面的知识之前已经提过，就不多赘述，那么来说说网关吧</p>
<p>网关是负责将OSI模型中从传输层到应用层的数据进行转换和转发的设备。它和4～7层交换机一样都是处理传输层以上的数据，网关不仅转发数据还会对数据进行转换，它通常会使用一个表示层或者应用层网关，在两个不能直接进行通信的协议之间进行翻译，最终实现两者之间的通信。</p>
<p>就好比说手机的邮件有时会和互联网的邮件不兼容，这是由于它们在表示层和应用层之间的电子应用协议互不相同所导致。</p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/33D1998EBE60340EE0E2CB4067AC6F57.png" alt=""></p>
<p>其中代理服务器也算是网关，被称作应用网关，在我大天朝也是应用广泛，应用方面自行体会～</p>
<h3 id="互联网通信"><a class="markdownIt-Anchor" href="#互联网通信"></a> 互联网通信</h3>
<p>人们在家或公司一般都会使用互联网接入服务，汇集到无限局域网路由器和最近交换机的通信会被连接到所谓的&quot;接入层&quot;，甚至通过边缘网络或主干网实现与目标地址进行通信。</p>
<p>如果是移动通信，手机一开机，就会自动和距离最近的基站发生无线通信。基站设有特定的手机基站天线，本身相当于网络的接入层。</p>
<p>基站收集的通信请求被汇集到控制中心（“边缘网络”），之后再被接入到主干网。</p>
<p>如果是从一个信息发布者的角度来看的话，对于那些巨大的访问量，会采用数据中心的模式，也就是托管主机服务，集合多个存储一起，通过连接高速网络减少网络延迟来提高响应的速度。</p>
<p><img src="http://omunhj2f1.bkt.clouddn.com/F541EB6888B188542B78B59340633E86.png" alt=""></p>
<p>数据中心由大型服务器、存储和计算机网络构成，有些大型数据中心会直接连接主干网，就算小规模的议案也会连接到边缘网络。</p>
<p>数据中心的内部分布着三层交换机和高速路由器。</p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/程序员的自我修养/">#程序员的自我修养</a>
        </div>
    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    Hacking to the gate
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2018/10/11/Crashing-to-Root/">Crashing to Root</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/10/08/基于CVE-2017-7047的利用分析/">基于CVE-2017-7047的利用分析</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/09/20/iPhone中新引入的保护机制/">iPhone中新引入的保护机制</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2018/09/10/empty-list分析/">empty_list分析</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/UI学习-基础/">UI学习 基础</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/sumup/">sumup</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/动态规划/">动态规划</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/ARC自动回收机制/">ARC自动回收机制</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/peterpan0927">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/peterpan980927">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://plus.google.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-google-plus"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>